import{dj as D,dk as L,dl as V,dm as j,dn as x,dp as F,dq as W,dr as $,ds as R,dt as H,du as Y,dv as J,dw as Z,dx as O,dy as K,dz as X,dA as G,dB as U,dC as Q}from"./index-1773ed27.js";const tt=new Map,et=new Map;function st(t){const e=(n,o)=>({clear:()=>o.delete(n),get:()=>o.get(n),set:r=>o.set(n,r)}),s=e(t,tt),i=e(t,et);return{clear:()=>{s.clear(),i.clear()},promise:s,response:i}}async function it(t,{cacheKey:e,cacheTime:s=Number.POSITIVE_INFINITY}){const i=st(e),n=i.response.get();if(n&&s>0&&new Date().getTime()-n.created.getTime()<s)return n.data;let o=i.promise.get();o||(o=t(),i.promise.set(o));try{const r=await o;return i.response.set({created:new Date,data:r}),r}finally{i.promise.clear()}}async function nt(t,e,s){var o,r,a,c,u,h,l,p,d,y,w;const i=await D(e)(t,{headers:{...(a=(r=(o=e.config)==null?void 0:o.rpc)==null?void 0:r.fetch)==null?void 0:a.headers,"Content-Type":"application/json"},body:L(s.requests),method:"POST",requestTimeoutMs:s.requestTimeoutMs??((h=(u=(c=e.config)==null?void 0:c.rpc)==null?void 0:u.fetch)==null?void 0:h.requestTimeoutMs),keepalive:(d=(p=(l=e.config)==null?void 0:l.rpc)==null?void 0:p.fetch)==null?void 0:d.keepalive});if(!i.ok)throw(y=i.body)==null||y.cancel(),new Error(`RPC request failed with status ${i.status} - ${i.statusText}`);if((w=i.headers.get("Content-Type"))!=null&&w.startsWith("application/json"))return await i.json();const n=await i.text();try{return JSON.parse(n)}catch(T){throw console.error("Error parsing response",T,n),T}}async function rt(t,e,s){var o,r,a,c,u,h,l,p,d,y,w;const i=await D(e)(t,{headers:{...((a=(r=(o=e.config)==null?void 0:o.rpc)==null?void 0:r.fetch)==null?void 0:a.headers)||{},"Content-Type":"application/json"},body:L(s.request),method:"POST",requestTimeoutMs:s.requestTimeoutMs??((h=(u=(c=e.config)==null?void 0:c.rpc)==null?void 0:u.fetch)==null?void 0:h.requestTimeoutMs),keepalive:(d=(p=(l=e.config)==null?void 0:l.rpc)==null?void 0:p.fetch)==null?void 0:d.keepalive});if(!i.ok)throw(y=i.body)==null||y.cancel(),new Error(`RPC request failed with status ${i.status}`);if((w=i.headers.get("Content-Type"))!=null&&w.startsWith("application/json"))return await i.json();const n=await i.text();try{return JSON.parse(n)}catch(T){throw console.error("Error parsing response",T,n),T}}const z=new WeakMap;function ot(t){if(z.has(t))return z.get(t);const e=new Map;return z.set(t,e),e}function at(t){return`${t.method}:${JSON.stringify(t.params)}`}const ct=100,ut=0;function ht(t){const e=ot(t.client),s=t.chain.id;if(e.has(t.chain.rpc))return e.get(t.chain.rpc);const i=(()=>{var l,p,d,y,w,T;const n=V({client:t.client,chain:t.chain}),o=((l=t.config)==null?void 0:l.maxBatchSize)??((d=(p=t.client.config)==null?void 0:p.rpc)==null?void 0:d.maxBatchSize)??ct,r=((y=t.config)==null?void 0:y.batchTimeoutMs)??((T=(w=t.client.config)==null?void 0:w.rpc)==null?void 0:T.batchTimeoutMs)??ut,a=new Map;let c=[],u=null;function h(){var C;u&&(clearTimeout(u),u=null);const P=new Array(c.length),b=c.slice().map((m,f)=>(m.request.id=f,m.request.jsonrpc="2.0",P[f]=m.request,m));c=[],nt(n,t.client,{requests:P,requestTimeoutMs:(C=t.config)==null?void 0:C.requestTimeoutMs}).then(m=>{b.forEach((f,A)=>{const g=m[A];if(!g){f.reject(new Error("No response"));return}if(g instanceof Error){f.reject(g);return}if(typeof g=="string"){f.reject(new Error(g));return}if("error"in g)f.reject(g.error);else{if(g.method==="eth_subscription")throw new Error("Subscriptions not supported yet");f.resolve(g.result)}a.delete(f.requestKey)})}).catch(m=>{for(const f of b)f.reject(m),a.delete(f.requestKey)})}return o===1?async P=>{var C;P.id=1,P.jsonrpc="2.0";const b=await rt(n,t.client,{request:P,requestTimeoutMs:(C=t.config)==null?void 0:C.requestTimeoutMs});if(!b)throw new Error("No response");if("error"in b)throw b.error;return b.result}:async P=>{const b=at(P);if(a.has(b))return a.get(b);let C,m;const f=new Promise((A,g)=>{C=A,m=g});return a.set(b,f),c.push({request:P,resolve:C,reject:m,requestKey:b}),o>1?(u||(u=setTimeout(h,r)),c.length>=o&&h()):h(),f}})();return e.set(s,i),i}function dt(t){return Object.fromEntries(Object.entries(t).map(([e,s])=>[e,{balance:s.balance?j(s.balance):void 0,nonce:s.nonce?j(s.nonce):void 0,code:s.code,state:s.state,stateDiff:s.stateDiff}]))}async function lt(t,e){const{blockNumber:s,blockTag:i,...n}=e,r=(s?j(s):void 0)||i||"latest";return await t({method:"eth_call",params:e.stateOverrides?[n,r,dt(e.stateOverrides)]:[n,r]})}function q(t,{includeName:e=!1}={}){return t?t.map(s=>ft(s,{includeName:e})).join(e?", ":","):""}function ft(t,{includeName:e}){return t.type.startsWith("tuple")?`(${q(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}class pt extends x{constructor({data:e,params:s,size:i}){super([`Data size of ${i} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${q(s,{includeName:!0})})`,`Data:   ${e} (${i} bytes)`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=s,this.size=i}}class yt extends x{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.'),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiDecodingZeroDataError"})}}class bt extends x{constructor(e,{docsPath:s}){super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:s}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiDecodingType"})}}function S(t,{dir:e="left"}={}){let s=typeof t=="string"?t.replace("0x",""):t,i=0;for(let n=0;n<s.length-1&&s[e==="left"?n:s.length-n-1].toString()==="0";n++)i++;return s=e==="left"?s.slice(i):s.slice(0,s.length-i),typeof t=="string"?(s.length===1&&e==="right"&&(s=`${s}0`),`0x${s.length%2===1?`0${s}`:s}`):s}class mt extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}set(e,s){return super.set(e,s),this.maxSize&&this.size>this.maxSize&&this.delete(this.keys().next().value),this}}const M=new mt(8192);function gt(t,e){if(M.has(`${t}.${e}`))return M.get(`${t}.${e}`);const s=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),i=F(W(s),"bytes"),n=(e?s.substring(`${e}0x`.length):s).split("");for(let r=0;r<40;r+=2)i[r>>1]>>4>=8&&n[r]&&(n[r]=n[r].toUpperCase()),(i[r>>1]&15)>=8&&n[r+1]&&(n[r+1]=n[r+1].toUpperCase());const o=`0x${n.join("")}`;return M.set(`${t}.${e}`,o),o}function k(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}class I extends x{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"NegativeOffsetError"})}}class wt extends x{constructor({length:e,position:s}){super(`Position \`${s}\` is out of bounds (\`0 < position < ${e}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PositionOutOfBoundsError"})}}class Pt extends x{constructor({count:e,limit:s}){super(`Recursive read limit of \`${s}\` exceeded (recursive read count: \`${e}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RecursiveReadLimitExceededError"})}}const vt={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new Pt({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new wt({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new I({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new I({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const s=e??this.position;return this.assertPosition(s+t-1),this.bytes.subarray(s,s+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const s=this.inspectBytes(t);return this.position+=e??t,s},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function Tt(t,{recursiveReadLimit:e=8192}={}){const s=Object.create(vt);return s.bytes=t,s.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength),s.positionReadCount=new Map,s.recursiveReadLimit=e,s}function Ct(t,e={}){typeof e.size<"u"&&$(t,{size:e.size});const s=R(t,e);return H(s,e)}function Bt(t,e={}){let s=t;if(typeof e.size<"u"&&($(s,{size:e.size}),s=S(s)),s.length>1||s[0]>1)throw new Y(s);return!!s[0]}function v(t,e={}){typeof e.size<"u"&&$(t,{size:e.size});const s=R(t,e);return J(s,e)}function Rt(t,e={}){let s=t;return typeof e.size<"u"&&($(s,{size:e.size}),s=S(s,{dir:"right"})),new TextDecoder().decode(s)}function xt(t,e){const s=typeof e=="string"?Z(e):e,i=Tt(s);if(O(s)===0&&t.length>0)throw new yt;if(O(e)&&O(e)<32)throw new pt({data:typeof e=="string"?e:R(e),params:t,size:O(e)});let n=0;const o=[];for(let r=0;r<t.length;++r){const a=t[r];i.setPosition(n);const[c,u]=B(i,a,{staticPosition:0});n+=u,o.push(c)}return o}function B(t,e,{staticPosition:s}){const i=k(e.type);if(i){const[n,o]=i;return Ot(t,{...e,type:o},{length:n,staticPosition:s})}if(e.type==="tuple")return zt(t,e,{staticPosition:s});if(e.type==="address")return Et(t);if(e.type==="bool")return Ut(t);if(e.type.startsWith("bytes"))return $t(t,e,{staticPosition:s});if(e.type.startsWith("uint")||e.type.startsWith("int"))return At(t,e);if(e.type==="string")return Mt(t,{staticPosition:s});throw new bt(e.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const _=32,N=32;function Et(t){const e=t.readBytes(32);return[gt(R(K(e,-20))),32]}function Ot(t,e,{length:s,staticPosition:i}){if(!s){const r=v(t.readBytes(N)),a=i+r,c=a+_;t.setPosition(a);const u=v(t.readBytes(_)),h=E(e);let l=0;const p=[];for(let d=0;d<u;++d){t.setPosition(c+(h?d*32:l));const[y,w]=B(t,e,{staticPosition:c});l+=w,p.push(y)}return t.setPosition(i+32),[p,32]}if(E(e)){const r=v(t.readBytes(N)),a=i+r,c=[];for(let u=0;u<s;++u){t.setPosition(a+u*32);const[h]=B(t,e,{staticPosition:a});c.push(h)}return t.setPosition(i+32),[c,32]}let n=0;const o=[];for(let r=0;r<s;++r){const[a,c]=B(t,e,{staticPosition:i+n});n+=c,o.push(a)}return[o,n]}function Ut(t){return[Bt(t.readBytes(32),{size:32}),32]}function $t(t,e,{staticPosition:s}){const[i,n]=e.type.split("bytes");if(!n){const r=v(t.readBytes(32));t.setPosition(s+r);const a=v(t.readBytes(32));if(a===0)return t.setPosition(s+32),["0x",32];const c=t.readBytes(a);return t.setPosition(s+32),[R(c),32]}return[R(t.readBytes(Number.parseInt(n),32)),32]}function At(t,e){const s=e.type.startsWith("int"),i=Number.parseInt(e.type.split("int")[1]||"256"),n=t.readBytes(32);return[i>48?Ct(n,{signed:s}):v(n,{signed:s}),32]}function zt(t,e,{staticPosition:s}){const i=e.components.length===0||e.components.some(({name:r})=>!r),n=i?[]:{};let o=0;if(E(e)){const r=v(t.readBytes(N)),a=s+r;for(let c=0;c<e.components.length;++c){const u=e.components[c];t.setPosition(a+o);const[h,l]=B(t,u,{staticPosition:a});o+=l,n[i?c:u==null?void 0:u.name]=h}return t.setPosition(s+32),[n,32]}for(let r=0;r<e.components.length;++r){const a=e.components[r],[c,u]=B(t,a,{staticPosition:s});n[i?r:a==null?void 0:a.name]=c,o+=u}return[n,o]}function Mt(t,{staticPosition:e}){const s=v(t.readBytes(32)),i=e+s;t.setPosition(i);const n=v(t.readBytes(32));if(n===0)return t.setPosition(e+32),["",32];const o=t.readBytes(n,32),r=Rt(S(o));return t.setPosition(e+32),[r,32]}function E(t){var i;const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return(i=t.components)==null?void 0:i.some(E);const s=k(t.type);return!!(s&&E({...t,type:s[1]}))}async function jt(t){const{contract:e,method:s,params:i}=t,n=async()=>{var l,p;if(Array.isArray(s))return s;if(G(s))return U(s);if(typeof s=="function")return U(await s(e));if(typeof s=="string"&&s.startsWith("function ")){const d=Q(s);if(d.type==="function")return U(d);throw new Error('"method" passed is not of type "function"')}if(e.abi&&((l=e.abi)==null?void 0:l.length)>0){const d=(p=e.abi)==null?void 0:p.find(y=>y.type==="function"&&y.name===s);if(d)return U(d)}throw new Error(`Could not resolve method "${s}".`)},[o,r]=await Promise.all([n(),typeof i=="function"?i():i]);let a;o[1].length===0?a=o[0]:a=o[0]+X(o[1],r).slice(2);const c=ht({chain:e.chain,client:e.client}),u=await lt(c,{data:a,to:e.address}),h=xt(o[2],u);return Array.isArray(h)&&h.length===1?h[0]:h}const Nt="0x313ce567",St=[],It=[{type:"uint8"}];async function _t(t){return jt({contract:t.contract,method:[Nt,St,It],params:[]})}async function Lt(t){return it(()=>_t(t),{cacheKey:`${t.contract.chain.id}:${t.contract.address}:decimals`,cacheTime:Number.POSITIVE_INFINITY})}export{Lt as decimals};
