import{ct as m,as as L,cs as H,B as C,cu as E,cv as y,cw as U,cx as _,cy as I,cz as D,cA as x,i as F,l as G,x as S}from"./index-ce819469.js";function O(i,t="hex"){const e=w(i),n=m(new Uint8Array(e.length));return e.encode(n),t==="hex"?L(n.bytes):n.bytes}function w(i){return Array.isArray(i)?k(i.map(t=>w(t))):z(i)}function k(i){const t=i.reduce((s,c)=>s+c.length,0),e=A(t);return{length:(()=>t<=55?1+t:1+e+t)(),encode(s){t<=55?s.pushByte(192+t):(s.pushByte(192+55+e),e===1?s.pushUint8(t):e===2?s.pushUint16(t):e===3?s.pushUint24(t):s.pushUint32(t));for(const{encode:c}of i)c(s)}}}function z(i){const t=typeof i=="string"?H(i):i,e=A(t.length);return{length:(()=>t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+e+t.length)(),encode(s){t.length===1&&t[0]<128?s.pushBytes(t):t.length<=55?(s.pushByte(128+t.length),s.pushBytes(t)):(s.pushByte(128+55+e),e===1?s.pushUint8(t.length):e===2?s.pushUint16(t.length):e===3?s.pushUint24(t.length):s.pushUint32(t.length),s.pushBytes(t))}}}function A(i){if(i<2**8)return 1;if(i<2**16)return 2;if(i<2**24)return 3;if(i<2**32)return 4;throw new C("Length is too large.")}const R=2n**16n-1n,q=2n**96n-1n,J=2n**256n-1n;function T(i,t,e,n){if(typeof i.setBigUint64=="function")return i.setBigUint64(t,e,n);const s=BigInt(32),c=BigInt(4294967295),h=Number(e>>s&c),f=Number(e&c),r=n?4:0,a=n?0:4;i.setUint32(t+r,h,n),i.setUint32(t+a,f,n)}const M=(i,t,e)=>i&t^~i&e,V=(i,t,e)=>i&t^i&e^t&e;class W extends E{constructor(t,e,n,s){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=y(this.buffer)}update(t){U(this);const{view:e,buffer:n,blockLen:s}=this;t=_(t);const c=t.length;for(let h=0;h<c;){const f=Math.min(s-this.pos,c-h);if(f===s){const r=y(t);for(;s<=c-h;h+=s)this.process(r,h);continue}n.set(t.subarray(h,h+f),this.pos),this.pos+=f,h+=f,this.pos===s&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){U(this),I(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:s,isLE:c}=this;let{pos:h}=this;e[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>s-h&&(this.process(n,0),h=0);for(let o=h;o<s;o++)e[o]=0;T(n,s-8,BigInt(this.length*8),c),this.process(n,0);const f=y(t),r=this.outputLen;if(r%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=r/4,u=this.get();if(a>u.length)throw new Error("_sha2: outputLen bigger than state");for(let o=0;o<a;o++)f.setUint32(4*o,u[o],c)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:s,finished:c,destroyed:h,pos:f}=this;return t.length=s,t.pos=f,t.finished=c,t.destroyed=h,s%e&&t.buffer.set(n),t}}const N=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),l=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),b=new Uint32Array(64);class $ extends W{constructor(){super(64,32,8,!1),this.A=l[0]|0,this.B=l[1]|0,this.C=l[2]|0,this.D=l[3]|0,this.E=l[4]|0,this.F=l[5]|0,this.G=l[6]|0,this.H=l[7]|0}get(){const{A:t,B:e,C:n,D:s,E:c,F:h,G:f,H:r}=this;return[t,e,n,s,c,h,f,r]}set(t,e,n,s,c,h,f,r){this.A=t|0,this.B=e|0,this.C=n|0,this.D=s|0,this.E=c|0,this.F=h|0,this.G=f|0,this.H=r|0}process(t,e){for(let o=0;o<16;o++,e+=4)b[o]=t.getUint32(e,!1);for(let o=16;o<64;o++){const d=b[o-15],g=b[o-2],B=x(d,7)^x(d,18)^d>>>3,p=x(g,17)^x(g,19)^g>>>10;b[o]=p+b[o-7]+B+b[o-16]|0}let{A:n,B:s,C:c,D:h,E:f,F:r,G:a,H:u}=this;for(let o=0;o<64;o++){const d=x(f,6)^x(f,11)^x(f,25),g=u+d+M(f,r,a)+N[o]+b[o]|0,p=(x(n,2)^x(n,13)^x(n,22))+V(n,s,c)|0;u=a,a=r,r=f,f=h+g|0,h=c,c=s,s=n,n=g+p|0}n=n+this.A|0,s=s+this.B|0,c=c+this.C|0,h=h+this.D|0,f=f+this.E|0,r=r+this.F|0,a=a+this.G|0,u=u+this.H|0,this.set(n,s,c,h,f,r,a,u)}roundClean(){b.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const j=D(()=>new $);function P(i,t){const e=t||"hex",n=j(F(i,{strict:!1})?G(i):i);return e==="bytes"?n:S(n)}export{R as a,J as b,q as m,P as s,O as t};
